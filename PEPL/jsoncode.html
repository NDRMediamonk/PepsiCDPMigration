%%[
    var @PointsBalancenumber,@points
    SET @PointsBalancenumber = ""
set @json = Lookup("ent.PTR - Active Base QA_PTR - Active Bas_1sgDo000000008aIAA_85RDo000000007NMAQ_I", "LoyaltyProgramMember","EmailAddress", emailAddress)

/*---build a simple string from JSON data---*/ 
    SET @string = Replace(@json, "{", "") 
    SET @string = Replace(@string, "}", "") 
    SET @string = Replace(@string, " ", "") 
    SET @string = Replace(@string, "[", "") 
    SET @string = Replace(@string, "]", "") 
    SET @string = Replace(@string, '"', '')
    SET @string = Replace(@string, ':', ',')
    

/*---build a rowset---*/ 
    SET @JSONrows = BuildRowsetFromString(@string,",")
    SET @JSONrowCount = RowCount(@JSONrows)
]%%

%%[
 IF @JSONrowCount > 0 THEN
FOR @i = 1 TO @JSONrowCount DO
     SET @JSONrow = Row(@JSONrows, @i) 
        /* get row based on counter */
        SET @JSONvalue = Field(@JSONrow,1)
        IF @JSONvalue == "Points_Balance" then
            IF @PointsBalancenumber == "" then
            set @PointsBalancenumber = Add(@i,1)
            ELSE 
            set @PointsBalancenumber = concat(@PointsBalancenumber,",",Add(@i,1))
            ENDIF
            
        ENDIF
]%%

%%[NEXT @i 

ENDIF
  set @points = FormatNumber(Field(Row(@JSONrows, @PointsBalancenumber),1), 'N0', 'en-us')
  SET @points = Replace(@points, ",", "")
]%%
Points Balance: %%=v(@points)=%%
